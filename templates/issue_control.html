<div class="row">
    {% if type == 'issue' and num_issues > 0 or type == "answer" and num_answers > 0 %}
    <div class="col-12 text-center">
        <p>Number Found: {{ num_items }} Current Item: {{ item_num|add:1 }}</p>
    </div>
    {% else %}
    <div class="col-12 text-center">
        <p>No Items Present</p>
    </div>
    {% endif %}
</div>
<div class="row mb-1">
    {% if type == 'issue' and num_issues > 0 or type == "answer" and num_answers > 0 %}
    <div class="col-xs-4 col-sm-2 col-md-2">
        {% if item_num == 0 %}
        <a href="{% url 'step_issue' issue_num=0 answer_num=0 search_field=search_field%}">
            <button class="btn-edit-submit">Prev</button>
        </a>
        {% else %} 
            {% with item_num=item_num|add:-1 %} 
                {% if type == 'issue' %}
                <a href="{% url 'step_issue' issue_num=item_num answer_num=0 search_field=search_field %}">
                    <button class="btn-edit-submit">Prev</button>
                </a>
                {% else %}
                <a href="{% url 'step_issue' issue_num=0 answer_num=item_num search_field=search_field %}">
                    <button class="btn-edit-submit">Prev</button>
                </a>
                {% endif %}
            {% endwith %}
        {% endif %}
    </div>
    {% else %}
    <div class="col-2"></div>
    {% endif %}

    {% if user.is_superuser %}
        {% if num_items > 0 %}
        <div class="col-1"></div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'add_issue' %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% else %}
            <a href="{% url 'add_answer' issue_id=issue.id %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% endif %}
        </div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'edit_issue' edit=1 issue_num=issue_num search_field=search_field issue_id=0 %}">
                <button class="btn-edit-submit">Edit</button>
            </a>
            {% else %}
            <a href="{% url 'edit_answer' issue_id=issue.id answer_id=answer.id %}">
                <button class="btn-edit-submit">Edit</button>
            </a>
            {% endif %}
        </div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
                <button class="btn-edit-submit" id="deleteIssueButton">Delete</button>
            {% else %}
                <button class="btn-edit-submit" id="deleteAnswerButton">Delete</button>
            {% endif %}
        </div>
        <div class="col-1"></div>
        {% else %}
        <div class="col-3"></div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'add_issue' %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% else %}
            <a href="{% url 'add_answer' issue_id=issue.id %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% endif %}
        </div>
        <div class="col-3"></div>
        {% endif %}

    {% elif user.is_authenticated %}
        {% if num_items == 0 %}
        <div class="col-3"></div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'add_issue' %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% else %}
            <a href="{% url 'add_answer' issue_id=issue.id %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% endif %}
        </div>
        <div class="col-5"></div>
        {% elif type == "issue" and issue.author.username == user.username or type == "answer" and answer.author.username == user.username %}
        <div class="col-2"></div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'add_issue' %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% else %}
            <a href="{% url 'add_answer' issue_id=issue.id %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% endif %}
        </div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'edit_issue' edit=1 issue_num=issue_num search_field=search_field issue_id=0 %}">
                <button class="btn-edit-submit">Edit</button>
            </a>
            {% else %}
            <a href="{% url 'edit_answer' issue_id=issue.id answer_id=answer.id %}">
                <button class="btn-edit-submit">Edit</button>
            </a>
            {% endif %}
        </div>
        <div class="col-2"></div>
        {% else %}
        <div class="col-3"></div>
        <div class="col-xs-4 col-sm-2 col-md-2">
            {% if type == "issue" %}
            <a href="{% url 'add_issue' %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% else %}
            <a href="{% url 'add_answer' issue_id=issue.id %}">
                <button class="btn-edit-submit">New</button>
            </a>
            {% endif %}
        </div>
        <div class="col-3"></div>
        {% endif %}
       
    {% else %}
     <div class="col-xs-0 col-sm-8"></div>
    {% endif %}

    {% if type == 'issue' and num_issues > 0 or type == "answer" and num_answers > 0 %}
    <div class="col-xs-4 col-sm-2 col-md-2">
        {% with item_num=item_num|add:1 %}
            {% if type == 'issue' %}
            <a href="{% url 'step_issue' issue_num=item_num answer_num=0 search_field=search_field %}">
                <button class="btn-edit-submit">Next</button>
            </a>
            {% else %}
            <a href="{% url 'step_issue' issue_num=issue_num answer_num=item_num search_field=search_field %}">
                <button class="btn-edit-submit">Next</button>
            </a>
            {% endif %}
        {% endwith %}
    </div>
    {% endif %}
</div>

<!-- Modal for delete operation -->
<!-- for the corresponding script see base.html -->
<div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content delete-modal">
            <div class="modal-header">
                <h5 class="modal-title" id="confirmationModalLabel">Confirmation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                <button type="button" class="btn btn-primary" id="confirmButton">Yes</button>
            </div>
        </div>
    </div>
</div>
  
<script>
    var deleteIssueUrl = "{% url 'delete_issue' issue_id=issue.id %}";
    var issueId = "{{ issue.id }}";
    {% if answer %}
        var deleteAnswerUrl = "{% url 'delete_answer' issue_id=issue.id answer_id=answer.id %}";
    {% endif %}
    var deleteItemUrl = ""; // Global for alternative value
    var answerId = "{{ answer.id }}";
</script>